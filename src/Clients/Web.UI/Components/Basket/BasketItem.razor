@using Web.UI.Models

<div class="card mb-3">
    <div class="card-body">
        <div class="row align-items-center">
            <div class="col-md-6">
                <h5 class="card-title">@Item.ProductName</h5>
                <p class="text-muted mb-0">Birim Fiyat: @Item.Price.ToString("C")</p>
            </div>
            <div class="col-md-3">
                <div class="input-group">
                    <button class="btn btn-outline-secondary" type="button" @onclick="DecreaseQuantity">-</button>
                    <input type="number" class="form-control text-center" value="@Item.Quantity" @onchange="OnQuantityChanged" min="1" />
                    <button class="btn btn-outline-secondary" type="button" @onclick="IncreaseQuantity">+</button>
                </div>
            </div>
            <div class="col-md-2 text-end">
                <strong>@((Item.Price * Item.Quantity).ToString("C"))</strong>
            </div>
            <div class="col-md-1">
                <button class="btn btn-danger btn-sm" @onclick="() => OnRemove.InvokeAsync(Item)">
                    âœ•
                </button>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public ShoppingCartItemDto Item { get; set; } = default!;

    [Parameter]
    public EventCallback OnUpdate { get; set; }

    [Parameter]
    public EventCallback<ShoppingCartItemDto> OnRemove { get; set; }

    private async Task IncreaseQuantity()
    {
        Item.Quantity++;
        await OnUpdate.InvokeAsync();
    }

    private async Task DecreaseQuantity()
    {
        if (Item.Quantity > 1)
        {
            Item.Quantity--;
            await OnUpdate.InvokeAsync();
        }
    }

    private async Task OnQuantityChanged(ChangeEventArgs e)
    {
        if (int.TryParse(e.Value?.ToString(), out int quantity) && quantity > 0)
        {
            Item.Quantity = quantity;
            await OnUpdate.InvokeAsync();
        }
    }
}

