@using Web.UI.Models

<RadzenCard>
    <RadzenRow AlignItems="AlignItems.Center" Gap="1rem">
        <RadzenColumn Size="12" SizeMD="6">
            <RadzenStack Gap="0.25rem">
                <RadzenHeading Size="HeadingSize.H5" Text="@Item.ProductName" />
                <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" AlignItems="AlignItems.Center">
                    <RadzenLabel Style="color: var(--rz-text-secondary-color);">
                        Birim Fiyat: @Item.Price.ToString("C")
                    </RadzenLabel>
                    @if (Item.Discount > 0)
                    {
                        <RadzenBadge Text="@($"Ä°ndirim: -{Item.Discount.ToString("C")}")" BadgeStyle="BadgeStyle.Success" />
                    }
                </RadzenStack>
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="3">
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                <RadzenButton Icon="remove" ButtonStyle="ButtonStyle.Secondary" Variant="Variant.Outlined" Size="ButtonSize.Small" Click="@DecreaseQuantity" Disabled="@(Item.Quantity <= 1)" />
                <RadzenNumeric TValue="int" Value="@Item.Quantity" Min="1" Style="width: 80px;" ValueChanged="@OnQuantityChanged" />
                <RadzenButton Icon="add" ButtonStyle="ButtonStyle.Secondary" Variant="Variant.Outlined" Size="ButtonSize.Small" Click="@IncreaseQuantity" />
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="2">
            <RadzenStack Gap="0.25rem" Style="text-align: right;">
                @if (Item.Discount > 0)
                {
                    <RadzenLabel Text="@((Item.Price * Item.Quantity - Item.Discount).ToString("C"))" Style="font-weight: 600; color: var(--rz-primary);" />
                    <RadzenLabel Text="@((Item.Price * Item.Quantity).ToString("C"))" Style="font-size: 0.875rem; text-decoration: line-through; color: var(--rz-text-secondary-color);" />
                }
                else
                {
                    <RadzenLabel Text="@((Item.Price * Item.Quantity).ToString("C"))" Style="font-weight: 600;" />
                }
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="1">
            <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Danger" Size="ButtonSize.Small" Click="@(() => OnRemove.InvokeAsync(Item))" />
        </RadzenColumn>
    </RadzenRow>
</RadzenCard>

@code {
    [Parameter]
    public ShoppingCartItemDto Item { get; set; } = default!;

    [Parameter]
    public EventCallback OnUpdate { get; set; }

    [Parameter]
    public EventCallback<ShoppingCartItemDto> OnRemove { get; set; }

    private async Task IncreaseQuantity()
    {
        Item.Quantity++;
        await OnUpdate.InvokeAsync();
    }

    private async Task DecreaseQuantity()
    {
        if (Item.Quantity > 1)
        {
            Item.Quantity--;
            await OnUpdate.InvokeAsync();
        }
    }

    private async Task OnQuantityChanged(int value)
    {
        if (value > 0)
        {
            Item.Quantity = value;
            await OnUpdate.InvokeAsync();
        }
    }
}

