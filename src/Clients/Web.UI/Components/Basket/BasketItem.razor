@using Web.UI.Models

<RadzenCard>
    <RadzenRow AlignItems="AlignItems.Center" Gap="1rem">
        <RadzenColumn Size="12" SizeMD="6">
            <RadzenStack Gap="0.25rem">
                <RadzenHeading Size="HeadingSize.H5" Text="@Item.ProductName" />
                <RadzenLabel Style="color: var(--rz-text-secondary-color);">
                    Birim Fiyat: @Item.Price.ToString("C")
                </RadzenLabel>
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="3">
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                <RadzenButton Icon="remove" ButtonStyle="ButtonStyle.Secondary" Variant="Variant.Outlined" Size="ButtonSize.Small" Click="@DecreaseQuantity" Disabled="@(Item.Quantity <= 1)" />
                <RadzenNumeric TValue="int" Value="@Item.Quantity" Min="1" Style="width: 80px;" ValueChanged="@OnQuantityChanged" />
                <RadzenButton Icon="add" ButtonStyle="ButtonStyle.Secondary" Variant="Variant.Outlined" Size="ButtonSize.Small" Click="@IncreaseQuantity" />
            </RadzenStack>
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="2">
            <RadzenLabel Text="@((Item.Price * Item.Quantity).ToString("C"))" Style="font-weight: 600; text-align: right;" />
        </RadzenColumn>
        <RadzenColumn Size="12" SizeMD="1">
            <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Danger" Size="ButtonSize.Small" Click="@(() => OnRemove.InvokeAsync(Item))" />
        </RadzenColumn>
    </RadzenRow>
</RadzenCard>

@code {
    [Parameter]
    public ShoppingCartItemDto Item { get; set; } = default!;

    [Parameter]
    public EventCallback OnUpdate { get; set; }

    [Parameter]
    public EventCallback<ShoppingCartItemDto> OnRemove { get; set; }

    private async Task IncreaseQuantity()
    {
        Item.Quantity++;
        await OnUpdate.InvokeAsync();
    }

    private async Task DecreaseQuantity()
    {
        if (Item.Quantity > 1)
        {
            Item.Quantity--;
            await OnUpdate.InvokeAsync();
        }
    }

    private async Task OnQuantityChanged(int value)
    {
        if (value > 0)
        {
            Item.Quantity = value;
            await OnUpdate.InvokeAsync();
        }
    }
}

