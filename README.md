cat << 'EOF'
## ðŸ—ï¸ Mimari

### Genel Mimari

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Gateway (YARP)                      â”‚
â”‚                      Port: 5000                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Catalog  â”‚      â”‚  Basket â”‚      â”‚ Ordering â”‚
â”‚   API    â”‚      â”‚   API   â”‚      â”‚   API    â”‚
â”‚  Port:   â”‚      â”‚  Port:  â”‚      â”‚  Port:   â”‚
â”‚  5001    â”‚      â”‚  5002   â”‚      â”‚  5003    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                  â”‚
     â”‚                 â”‚                  â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”          â”‚
     â”‚         â”‚       â”‚       â”‚          â”‚
     â”‚         â–¼       â–¼       â–¼          â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚          â”‚
     â”‚    â”‚PostgreSQLâ”‚ â”‚Redisâ”‚ â”‚          â”‚
     â”‚    â”‚BasketDb â”‚ â”‚Cache â”‚ â”‚          â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
     â”‚                         â”‚          â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
     â”‚         â”‚  gRPC         â”‚          â”‚
     â”‚         â”‚ (sync)        â”‚          â”‚
     â”‚         â–¼               â”‚          â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚          â”‚
     â”‚    â”‚ Discount â”‚         â”‚          â”‚
     â”‚    â”‚  (gRPC)  â”‚         â”‚          â”‚
     â”‚    â”‚ Port:    â”‚         â”‚          â”‚
     â”‚    â”‚ 5004     â”‚         â”‚          â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚          â”‚
     â”‚                         â”‚          â”‚
     â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚ RabbitMQ â”‚
     â”‚              â”‚ (async)  â”‚
     â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgreSQLâ”‚
â”‚CatalogDb â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DetaylÄ± Mimari (VeritabanlarÄ± ile)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Gateway (YARP)                      â”‚
â”‚                      Port: 5000                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Catalog  â”‚      â”‚  Basket â”‚      â”‚ Ordering â”‚
â”‚   API    â”‚      â”‚   API   â”‚      â”‚   API    â”‚
â”‚  Port:   â”‚      â”‚  Port:  â”‚      â”‚  Port:   â”‚
â”‚  5001    â”‚      â”‚  5002   â”‚      â”‚  5003    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                  â”‚
     â”‚                 â”‚                  â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”          â”‚
     â”‚         â”‚       â”‚       â”‚          â”‚
     â”‚         â–¼       â–¼       â–¼          â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚          â”‚
     â”‚    â”‚PostgreSQLâ”‚ â”‚Redisâ”‚ â”‚          â”‚
     â”‚    â”‚BasketDb â”‚ â”‚Cache â”‚ â”‚          â”‚
     â”‚    â”‚(Source) â”‚ â”‚(Cache)â”‚ â”‚          â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
     â”‚                         â”‚          â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
     â”‚         â”‚  gRPC         â”‚          â”‚
     â”‚         â”‚ (sync)        â”‚          â”‚
     â”‚         â–¼               â”‚          â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚          â”‚
     â”‚    â”‚ Discount â”‚         â”‚          â”‚
     â”‚    â”‚  (gRPC)  â”‚         â”‚          â”‚
     â”‚    â”‚ Port:    â”‚         â”‚          â”‚
     â”‚    â”‚ 5004     â”‚         â”‚          â”‚
     â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚          â”‚
     â”‚         â”‚               â”‚          â”‚
     â”‚         â–¼               â”‚          â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚          â”‚
     â”‚    â”‚PostgreSQLâ”‚         â”‚          â”‚
     â”‚    â”‚DiscountDbâ”‚         â”‚          â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚          â”‚
     â”‚                         â”‚          â”‚
     â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚ RabbitMQ â”‚
     â”‚              â”‚ (async)  â”‚
     â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgreSQLâ”‚
â”‚CatalogDb â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Servisler ArasÄ± Ä°letiÅŸim

- **Synchronous (gRPC)**: Basket.API â†’ Discount.Grpc (indirim sorgulama)
- **Asynchronous (RabbitMQ)**: Basket.API â†’ Ordering.API (checkout event)

### VeritabanÄ± DaÄŸÄ±lÄ±mÄ±

Her microservice kendi veritabanÄ±na sahiptir (Database per Service pattern):

- **Catalog.API** â†’ PostgreSQL (CatalogDb)
- **Basket.API** â†’ PostgreSQL (BasketDb) + **Redis (Cache)** - Cache-aside pattern
- **Ordering.API** â†’ PostgreSQL (OrderingDb)
- **Discount.Grpc** â†’ PostgreSQL (DiscountDb)

### Cache Stratejisi (Basket Service)

Basket Service **Cache-aside Pattern** kullanÄ±r:

```
Sepet Getirme:
1. Redis'te var mÄ±? â†’ Evet: Redis'ten dÃ¶ner
2. Redis'te yok mu? â†’ PostgreSQL'den alÄ±r â†’ Redis'e yazar â†’ DÃ¶ner

Sepet Kaydetme:
1. PostgreSQL'e yazar (source of truth)
2. Redis'e yazar (cache)
```

EOF
